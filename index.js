!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@ali/wpk-reporter")):"function"==typeof define&&define.amd?define(["exports","@ali/wpk-reporter"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).iLogger={},e.wpkReporter)}(this,(function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=n(t);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function u(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw i}}}}var s=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e?null:{},o=document.cookie?document.cookie.split("; "):[],r=/(%[0-9A-Z]{2})+/g,i=0;i<o.length;i++){var a=o[i].split("="),l=a.slice(1).join("=");t.json||'"'!==l.charAt(0)||(l=l.slice(1,-1));try{var c=a[0].replace(r,decodeURIComponent);if(l=l.replace(r,decodeURIComponent),t.json)try{l=JSON.parse(l)}catch(e){}if(e===c){n=l;break}e||(n[c]=l)}catch(e){}}return n},d={ID:{id:"360",lang:["id","en"],langShort:["id","en"],currency:"IDR",domain:"lazada.co.id",regionID:"ID"},MY:{id:"458",currency:"MYR",lang:["en-MY","ms","zh"],langShort:["en","ms","zh"],domain:"lazada.com.my",regionID:"MY"},PH:{id:"608",currency:"PHP",lang:["en-PH"],langShort:["en"],domain:"lazada.com.ph",regionID:"PH"},SG:{id:"702",currency:"SGD",lang:["en-SG"],langShort:["en"],domain:"lazada.sg",regionID:"SG"},TH:{id:"764",currency:"THB",lang:["th","en"],domain:"lazada.co.th",regionID:"TH"},VN:{id:"704",currency:"VND",lang:["vi","en"],domain:"lazada.vn",regionID:"VN"}},f=navigator.userAgent||"";function p(e){return e?e.split("|"):[]}function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e=e.toLocaleUpperCase();var n=d[e]?d[e].lang:[];if(!Array.isArray(n))return t;for(var o="",r=0;r<n.length;r++){var i=n[r];if(i&&i.indexOf(t)>-1){o=i;break}}return o||(o=n[0]),o}function w(){var e={},t={};if("undefined"==typeof window||"undefined"==typeof performance||"undefined"==typeof MutationObserver)void 0!==e&&(e.exports={on:function(){},un:function(){}});else{var n=function(){E.observe(document.body,x),T=[],p(document.querySelectorAll("[ignoreFspCollection]"),(function(e){T.push(e)})),c(document.querySelectorAll("BODY > *")),setTimeout((function(){o(!0)}),h)},o=function(e){O||(_=!0,b&&clearTimeout(b),E.disconnect(),E.takeRecords(),T=[],setTimeout((function(){O=!0,d(e)}),1e3))},r=function(e){return e.width&&e.height&&e.top<screen.height&&e.left<screen.width&&e.top+e.height>0&&e.left+e.width>0},i=function(e,t,n){var o=n||0;return p(e,(function(e){o=t(e,o)})),o},a=function(e){var t=function(){e.lastTime=Math.max(f(),e.lastTime),s()};window.requestAnimationFrame?requestAnimationFrame(t):setTimeout(t,0)},l=function e(t,n,o){var l=t.piece,c=document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop||0,d=document.documentElement.scrollLeft||window.pageXOffset||document.body.scrollLeft||0,g=o?null:n.getBoundingClientRect(),h=o||{type:0,className:u(n),top:g.top+c,left:g.left+d,width:g.width,height:g.height},m=n.offsetParent;m&&m.offsetWidth<m.scrollWidth&&(h.width=Math.min(m.offsetWidth,h.width)),m&&m.offsetHeight<m.scrollHeight&&(h.height=Math.min(m.offsetHeight,h.height));var v=!0,y=n.tagName;if(-1!==S.indexOf(y.toUpperCase())&&(v=!1,"IMG"===y)){var b=0;if(h.width=Math.max(h.width,1),h.height=Math.max(h.height,1),h.type=1,r(h)){t.wait+=1,n.addEventListener("load",(function e(){if(O)n.removeEventListener("load",e,!0);else{b++,t.wait-=1;var o=n.getBoundingClientRect(),l=f();r(h)&&(b<=1||l<=1e3)?(h.width=o.width,h.height=o.height,t.lastTime=Math.max(l,t.lastTime),h.size=o.width*o.height,h.v=h.size/w,t.v=i(t.piece,(function(e,t){return e.v+t}),0),a(t)):s()}}),!0),n.addEventListener("error",(function e(){O?n.removeEventListener("error",e,!0):(t.wait-=1,r(h)?(t.lastTime=Math.max(f(),t.lastTime),0===t.wait&&(t.v=i(t.piece,(function(e,t){return e.v+t}),0),a(t))):s())}),!0)}}var _={};if(window.getComputedStyle&&("none"===(_=window.getComputedStyle(n,null)).display||"fixed"===_.position))return v=!1,l;if(r(h)){var T=_.backgroundImage||"",E=/url\(['"]?(.*?)['"]?\)/i;if(E.test(T)&&(T=T.replace(E,"$1"),!/^data:/i.test(T))){t.wait+=1;var x=document.createElement("img");x.onload=function(){t.wait-=1,t.lastTime=Math.max(f(),t.lastTime),0===t.wait&&a(t)},x.src=T}if(function(e,t){var n=null;for(var o in e)if(n=e[o],t.top>=n.top&&t.left>=n.left&&t.top+t.height<=n.top+n.height&&t.left+t.width<=n.left+n.width)return!0;return!1}(l,h)||(h.size=h.width*h.height,h.v=h.size/w,t.v+=h.v,h.size?l.push(h):v=!1),v){var P=n.children;p(P,(function(n){e(t,n)}))}}return l},c=function(e){var t=f(),n={createTime:t,lastTime:t,wait:0,piece:[],v:0,c:document.getElementsByTagName("*").length};p(e,(function(e){(function(e){for(var t=T.length,n=null,o=0;o<t;o++)if((n=T[o])&&n.contains&&n.contains(e))return!0;return!!e.hasAttribute("ignoreFspCollection")&&(T.push(e),!0)})(e)||l(n,e)})),n.piece.length>0&&(g.push(n),a(n))},u=function(){if(!y)return""},s=function(){if(!_&&!O){b&&clearTimeout(b),b=setTimeout((function(){y&&console.log("stop By Idle"),o()}),m);for(var e=null,t=null,n=0,r=0,i=0,a=0,l=0,c=g.length-1;c>1;c--){if(e=g[c],t=g[c-1],a=Math.floor(100*e.v)/100,r=(l=Math.floor(100*t.v)/100)?Math.abs(a-l)/l:0,(i+=e.v)>2){y&&console.log("stop By sum area 2",i),o();break}if(r<.5){if(++n>6){y&&console.log("stop By stable tail"),o();break}}else n>0&&(n=0)}}},d=function(){var e=g.length;if(0!==e){var n=[],r=[],i=[],a=-1,l=0,c=0,u=null,s=null,d=0,f=0;for(e=g.length-1;e>1;e--)if(u=g[e],s=g[e-1],d=Math.floor(100*u.v)/100,f=Math.floor(100*s.v)/100,(l=f?Math.abs(d-f)/f:0)>.1){if(++c>2)break}else c=0;for(r=c>2?g.slice(0,e+2):g;r.length>0;)if(a=r[0].lastTime,i=[],l=0,c=0,p(r,(function(e){l+=e.v,c++,e.createTime<=a+v&&(a=Math.max(a,e.lastTime)),e.lastTime>a&&i.push(e)})),r=i,l<.02||l/c<.01?(y&&console.log("ignore min render"),P++):P=0,n.push(a),P>=3){y&&console.log("stop By keep min render 3"),n.splice(n.length-3),o();break}var w=n.length-1;0!==P&&(w=Math.max(w-P,0));var h=w===n.length?-3:w-1;h<=0&&(h=0),t._fn(n[w],n.slice(h,h+3))}},f=function(){return performance.now()},p=function(e,t){if(Array.prototype.forEach)Array.prototype.forEach.call(e,t);else for(var n=e.length,o=0;o<n;o++)t(e[o],o)},g=window._t2Frames=[],w=screen.width*screen.height,h=3e4,m=3e3,v=200,y=0,b=null,O=!1,_=!1,S=["SCRIPT","LINK","SVG","IMG","VIDEO"],T=[],E=new MutationObserver((function(e){var t=[],n=[];p(e,(function(e){p(e.addedNodes,(function(e){1!==e.nodeType&&9!==e.nodeType||t.push(e)}))})),t.length+n.length>0&&c(t.concat(n))})),x={childList:!0,subtree:!0};document.body?n():document.addEventListener&&document.addEventListener("DOMContentLoaded",n);var P=0;t.on=function(e){t._fn=e},t.un=function(){t._fn=function(){}},t.un(),void 0!==e&&(e.exports=t)}return e.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function h(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var m={exports:{}};!function(e,t){e.exports=function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==a(e)&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t){e.exports={sdk:{BID:"wpkreporter",CID:"jssdk",WID_KEY:"__wpkreporterwid_"},env:{BROWSER:"browser",NODEJS:"nodejs",WEEX:"weex"},px:{signKey:"Uvn#08uefVdwe&c4",addr:{cn:"http://px.effirst.com/api/v1/jssdk/upload",cn_https:"https://px.effirst.com/api/v1/jssdk/upload",intl:"http://px-intl.ucweb.com/api/v1/jssdk/upload",intl_https:"https://px-intl.ucweb.com/api/v1/jssdk/upload"},confAddr:{cn:"http://px.effirst.com/api/v1/jconfig",cn_https:"https://px.effirst.com/api/v1/jconfig",intl:"http://px-intl.ucweb.com/api/v1/jconfig",intl_https:"https://px-intl.ucweb.com/api/v1/jconfig"}},http:{methods:{GET:"GET",PUT:"PUT",POST:"POST",HEAD:"HEAD",DELETE:"DELETE",OPTIONS:"OPTIONS",CONNECT:"OPTIONS",TRACE:"OPTIONS",PATCH:"OPTIONS"},protocols:{HTTP:"http:",HTTPS:"https:"}},category:{JSERR:1,API:2,JSFSPERF:3,RESLOADFAIL:4,FLOW:5,BKPG:6,HARLOG:7,PERFNEXT:1e3},navConn:{types:{BLUETOOTH:"bluetooth",CELLULAR:"cellular",ETHERNET:"ethernet",MIXED:"mixed",NONE:"none",OTHER:"other",UNKNOWN:"unknown",WIFI:"wifi",WIMAX:"wimax"},effectiveTypes:{"2G":"2g","3G":"3g","4G":"4g",SLOW2G:"slow-2g"}}}},,function(e,t,n){var o=n(0).env,r=function(e){var t;return(e&&(t=e.replace(/^#\/?/,""))&&"string"==typeof t?t.replace(/^(https?:)?\/\//,"").replace(/\?.*$/,""):"")||"[index]"},i=function(e,t){if(t=t||{},e.env===o.BROWSER&&window)if(e.toolKit.extend({enable:!0},t).enable){e.logger.info("wpkflowPlugin已开启");var i,a,l=function(){e.reportFlow()};e.toolKit.onListen(window,"load",l,!0),e.spa&&(n(3)(),i=function(t){r(location.hash)&&(e._begin=Date.now(),e._sid=e.toolKit.uuid(),e.reportFlow())},a=function(t){r(t.detail)&&(e._begin=Date.now(),e._sid=e.toolKit.uuid(),e.reportFlow())},e.toolKit.onListen(window,"hashchange",i),e.toolKit.onListen(window,"historystatechange",a)),e.toolKit.onListen(window,"beforeunload",(function(){e.toolKit.offListen(window,"load"),e.toolKit.offListen(window,"hashchange"),e.toolKit.offListen(window,"historystatechange"),l=i=a=null}))}else e.logger.info("wpkflowPlugin已关闭")};i.prototype.pluginId="flow",e.exports=i},function(e,t){var n=window.history||{},o=window.document,r=function(e,t){var n;window.CustomEvent?n=new CustomEvent(e,{detail:t}):((n=o.createEvent("HTMLEvents")).initEvent(e,!1,!0),n.detail=t),window.dispatchEvent(n)},i=function(e){return e&&"string"==typeof e?e.replace(/^(https?:)?\/\//,"").replace(/\?.*$/,""):""},a=function(e){var t=n[e];"function"==typeof t&&(n[e]=function(e,o,a){var l=location.href,c=t.call(n,e,o,a);if(!a||"string"!=typeof a)return c;if(a===l)return c;try{var u=l.split("#"),s=a.split("#"),d=i(u[0]),f=i(s[0]),p=u[1]&&u[1].replace(/^\/?(.*)/,"$1"),g=s[1]&&s[1].replace(/^\/?(.*)/,"$1");d!==f?r("historystatechange",f):p!==g&&r("historystatechange",g)}catch(e){}return c},n[e].toString=e+"() { [native code] }")};e.exports=function(){a("pushState"),a("replateState")}}])}(m);var v=h(m.exports),y={exports:{}};!function(e,t){e.exports=function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==a(e)&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}({0:function(e,t){e.exports={sdk:{BID:"wpkreporter",CID:"jssdk",WID_KEY:"__wpkreporterwid_"},env:{BROWSER:"browser",NODEJS:"nodejs",WEEX:"weex"},px:{signKey:"Uvn#08uefVdwe&c4",addr:{cn:"http://px.effirst.com/api/v1/jssdk/upload",cn_https:"https://px.effirst.com/api/v1/jssdk/upload",intl:"http://px-intl.ucweb.com/api/v1/jssdk/upload",intl_https:"https://px-intl.ucweb.com/api/v1/jssdk/upload"},confAddr:{cn:"http://px.effirst.com/api/v1/jconfig",cn_https:"https://px.effirst.com/api/v1/jconfig",intl:"http://px-intl.ucweb.com/api/v1/jconfig",intl_https:"https://px-intl.ucweb.com/api/v1/jconfig"}},http:{methods:{GET:"GET",PUT:"PUT",POST:"POST",HEAD:"HEAD",DELETE:"DELETE",OPTIONS:"OPTIONS",CONNECT:"OPTIONS",TRACE:"OPTIONS",PATCH:"OPTIONS"},protocols:{HTTP:"http:",HTTPS:"https:"}},category:{JSERR:1,API:2,JSFSPERF:3,RESLOADFAIL:4,FLOW:5,BKPG:6,HARLOG:7,PERFNEXT:1e3},navConn:{types:{BLUETOOTH:"bluetooth",CELLULAR:"cellular",ETHERNET:"ethernet",MIXED:"mixed",NONE:"none",OTHER:"other",UNKNOWN:"unknown",WIFI:"wifi",WIMAX:"wimax"},effectiveTypes:{"2G":"2g","3G":"3g","4G":"4g",SLOW2G:"slow-2g"}}}},5:function(e,t,n){var o=n(0),r=o.sdk,i=o.http.methods,a=o.category,l=function(e){return e>=200&&e<=299},c=function(e){return-1===e.indexOf("//arms-retcode")&&-1===e.indexOf("//retcode.taobao.com")&&-1===e.indexOf("//retcode-sg-lazada.arms.aliyuncs.com")&&-1===e.indexOf("//mdap.alipay.com/loggw")&&-1===e.indexOf("//wpk-gateway")&&-1===e.indexOf("//px.ucweb.com")&&-1===e.indexOf("//px.effirst.com")&&-1===e.indexOf("//px-intl.ucweb.com")},s=function(e,t){if(e.hasOwnProperty(t))return e[t]},d=function(e,t,n){e.toolKit.isObject(n)&&e.toolKit.extend(t,{c1:s(n,"c1"),c2:s(n,"c2"),c3:s(n,"c3"),c4:s(n,"c4"),c5:s(n,"c5"),bl1:s(n,"bl1"),bl2:s(n,"bl2"),bl3:s(n,"bl3"),bl4:s(n,"bl4"),bl5:s(n,"bl5")}),e.report(t)};function f(e){try{if(!e)return{};var t,n={},o=u(e);try{for(o.s();!(t=o.n()).done;){var r=t.value;n[r[0]]=r[1]}}catch(e){o.e(e)}finally{o.f()}return n}catch(e){return{}}}var p=function(e,t){if(e.env===o.env.BROWSER&&window){var n=e.toolKit.extend({enable:!0,sampleRate:1},t);n.enable?(e.logger.info("wpkinterfacePlugin已开启"),"fetch"in window&&function(e,t){var n=window.fetch;window.fetch=function(){var o=[].slice.call(arguments),u=i.GET;o[1]&&o[1].method&&(u=o[1].method.toUpperCase());var s=Date.now();return n.apply(this,o).then((function(n){try{var p=Date.now(),g=(n.url||o[0]).split("?"),w=g[0],h=g[1]||"",m="",v=null;o[1]&&(v=o[1].headers),u!==i.GET&&o[1]&&o[1].body&&(m=JSON.stringify(o[1].body));var y=n.clone(),b=f(y.headers);y.text().then((function(o){o=o||"";var r=!0,i={};if("function"==typeof t.errorFilter&&(r=!!(i=t.errorFilter.call(this,{url:w,status:n.status,response:o,body:m,queryString:h,reqHeaders:v,resHeaders:b})),e.logger.warn("api errorFilter执行结果：",i)),o=o.length>2048?"[response content too large]":o,r&&p-s<121e3&&c(w)){var f=i.bizCode||n.status,g={category:a.API,sampleRate:t.sampleRate,w_res:w,w_param:h,w_body:l(f)||!t.withBody?"":m,w_method:u,w_rc:f,w_rt:p-s,w_resp:l(f)||!t.withResp?"":i.resp||o,msg:i.msg||"",w_type:16};d(e,g,i)}}))}catch(t){e.reportError(t,{bid:r.BID,cid:r.CID,category:a.JSERR,sampleRate:1})}return n})).catch((function(e){throw e}))}}(e,n),(e.enableMtop||n.enableMtop)&&(e.logger.info("use mtop"),function(e,t){window&&window.lib.mtop&&window.lib.mtop.middlewares&&window.lib.mtop.middlewares.push((function(n){var o=this.params,i=this.options,u=Date.now();return n().then((function(){try{if(i.H5Request&&(i.getJSON||i.postJSON))return void e.logger.debug("识别到请求为xhr, api监控交由xhr的方式处理");var n,s=i.retJson||{},f=Date.now()-u,p=s.code||200,g=o.type,w=i.path||i.api,h=e.toolKit.objToQueryString(i.querystring),m=i.postdata&&i.postdata.data?e.toolKit.objToJsonString(i.postdata.data):null,v=e.toolKit.objToJsonString(s.data||{}),y=s.ret;y instanceof Array&&(y=y.join(",")),-1===y.indexOf("SUCCESS")&&(n=y);var b=!0,O={};if("function"==typeof t.errorFilter&&(b=!!(O=t.errorFilter.call(this,{url:w,status:p,response:v,body:m,queryString:h,msg:n})),e.logger.warn("api errorFilter执行结果：",O)),b&&f<121e3&&c(w)){var _=O.bizCode||p,S={category:a.API,sampleRate:t.sampleRate,w_res:w,w_param:h,w_body:l(_)||!t.withBody?"":m,w_method:g,w_rc:_,w_rt:f,w_resp:l(_)||!t.withResp?"":O.resp||v,msg:O.msg||n||"",w_type:16};d(e,S,O)}}catch(t){e.reportError(t,{bid:r.BID,cid:r.CID,category:a.JSERR,sampleRate:1})}}))}))}(e,n))):e.logger.info("wpkinterfacePlugin已关闭")}};p.prototype.pluginId="api",e.exports=p}})}(y);var b=h(y.exports);var O=/AliApp/.test(f),_=s("lzd_uid"),S=(navigator.userAgent||"").toLowerCase().indexOf("android")>-1,T=function(){if(window.g_config&&window.g_config.cdnPath){var e,t=u(window.g_config.cdnPath.split("/"));try{for(t.s();!(e=t.n()).done;){var n=e.value;if(/\d.\d.\d/.test(n))return n}}catch(e){t.e(e)}finally{t.f()}}return""}(),E=!!document.querySelector("meta[name='wpk-bid']"),x={},P=!1,I=!1,j="perc5odk-tesq6o32";if(E){var k=document.head.querySelector('meta[name="wpk-bid"]');k&&k.getAttribute("content")&&(j=k.getAttribute("content"))}!E&&S&&console.warn("It is strongly recommended that integrate iTrace UC core monitor to your page, https://yuque.antfin-inc.com/wpk/help/vfx057");var D={en:"Network error, please try again later",id:"Kesalahan jaringan, coba lagi nanti",ms:"Ralat rangkaian, sila cuba lagi kemudian",my:"ကွန်ယက်ကိုအမှား, နောက်မှာထပ်ကြိုးစားကြည့်ပါ",th:"ข้อผิดพลาดของเครือข่ายโปรดลองอีกครั้งในภายหลัง",vi:"Lỗi mạng, vui lòng thử lại sau",bn:"নেটওয়ার্ক ত্রুটি, দয়া করে পরে আবার চেষ্টা করুন",si:"ජාල දෝෂය, නැවත උත්සාහ කරන්න",ne:"सञ्जाल त्रुटि, कृपया पछि फेरि प्रयास गर्नुहोस्",ur:"نیٹ ورک کی غلطی، براہ کرم بعد میں دوبارہ کوشش کریں"};function R(){var e=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t="",n="",o=p(s("hng"));if("object"===("undefined"==typeof window?"undefined":a(window))&&window._i18n_){var r=window._i18n_;if("string"==typeof r)try{r=JSON.parse(r)}catch(e){}"object"===a(r)&&(t=r.regionID,n=r.language)}if(!t&&window.g_config&&"object"===a(window.g_config)&&(t=window.g_config.regionID,n=window.g_config.language),!t&&"object"===("undefined"==typeof location?"undefined":a(location))&&location.hostname){for(var i in d){var l=d[i];if(l&&l.domain&&location.hostname.indexOf(l.domain)>-1){t=l.regionID;break}}o.length>1&&(n=o[1])}return t||o.length>=4&&(t=o[0],n=o[1]),n=g(t=t||"SG",n)||"en",e&&(n=n.substring(0,2)),{regionID:t.toLocaleUpperCase(),language:n}}().language;return D[(void 0===e?"EN":e).toLowerCase()]||D.en}var L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=null;return window.__wpk?(window.__wpk.setConfig(e),t=window.__wpk):(E&&O&&S?(t=new o.default({bid:e.pid||j,cid:e.cid||"",uid:e.uid||_,rel:e.rel||T,cluster:"intl",plugins:[[v,{enable:!1}]],debug:e.isDebug})).install():(t=new o.default({bid:e.pid||j,cid:e.cid||"",uid:e.uid||_,rel:e.rel||T,cluster:"intl",plugins:[[b,{enable:!1}]],debug:e.isDebug})).installAll(),window.__wpk=t),t},M=function(e,t,n,o,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},l=window.__wpk;window.__wpk||(l=L()),l.reportApiError(i({msg:r,url:e,method:t,status:o,spent:n,response:o},a),{})},A=function(e){I||(I=!0,window.__wpk||L(e),w&&w().on((function(t){window.__wpk&&window.__wpk.report&&window.__wpk.report({category:e.category||200,msg:"自定义首屏",wl_avgv1:Math.floor(t)-Math.floor(window.preLoadTime||0)})})))},N=function(e){var t;P||(window.__wpk||L(e),window,(t=window.lib||(window.lib={}))&&t.mtop&&!t.mtop.ERROR?(t.mtop.middlewares.push((function(e){var t=this.params,n=this.options,o=n.querystring,r=parseInt((void 0===o?{}:o).t)||Date.now();return e().then((function(){var e,o="",i="",a="",l=n.retJson,c=void 0===l?{}:l,s=n.path,d=c.api,f=c.responseHeaders,p=void 0===f?"":f,g=c.ret,w=function(e){var t,n=u(e.split("\r\n"));try{for(n.s();!(t=n.n()).done;){var o=t.value;if(o.indexOf("x-eagleeye-id")>-1){var r=o.split(":");return r[1]?r[1]:""}}}catch(e){n.e(e)}finally{n.f()}return""}(p),h=function(e){var t=e&&e.length&&e[0].split("::");return-1!==e[0].indexOf("FAIL_SYS")||-1!==e[0].indexOf("SYSTEM_ERROR")||-1!==e[0].indexOf("UNKNOWN_FAIL_CODE")||-1!==e[0].indexOf("TIMEOUT")?{key:t[0],displayMessage:R()}:t&&t[1]?{key:t[0],displayMessage:t[1]}:{key:e[0],displayMessage:R()}}(g),m=h.displayMessage,v=t.type||"";if(e=t.ext_headers&&t.ext_headers["x-uid"]||"",O){var y=n.subDomain,b=n.pageDomain,_=(n.results[0]||{}).stat,S=void 0===_?{}:_;i="SUCCESS"===h.key?200:0,o=S.oneWayTime||Date.now()-r,a=d?"https://".concat(y,".").concat(b,"/gw/").concat(d):"https:".concat(s)}else i="SUCCESS"===h.key?200:0,o=Date.now()-r,a="https:".concat(s);M(a,v,o,i,h.key,{c1:e,c2:w,c3:m})}))})),P=!0,console.log("[lzd-h5-itrace] mtop itrace plugin init success!")):console.warn("[lzd-h5-itrace] Mtop 没有初始化，无法添加 Mtop Itrace 监控插件！请参考 Mtop 文档 http://gitlab.alibaba-inc.com/mtb/lib-mtop ",t))};!function(){if(window){window.addEventListener("oniLoggerMtopPluginInit",(function(e){N(e.detail)}),!1);var e=!0;window.lib?window.lib.mtop&&(e=!1):window.lib={},e&&Object.defineProperty(window.lib,"mtop",{get:function(){return window.__lzdlib_mtop__},set:function(e){var t=new CustomEvent("oniLoggerMtopPluginInit",{detail:x||{}});window.dispatchEvent(t),window.__lzdlib_mtop__=e},configurable:!0,enumerable:!0});var t={selfDefineFSP:!0,mtopPluginInit:!0},n=document.head.querySelector('meta[name="lzd-itrace-close-auto-monitor"]');if(n&&n.getAttribute("content"))n.getAttribute("content").split(",").forEach((function(e){var n=e.trim();t[n]=!1}));L(),t.selfDefineFSP?A({}):console.log("[lzd-h5-itrace] close auto run selDefineFSP"),t.mtopPluginInit?N({}):console.log("[lzd-h5-itrace] close auto run mtopPluginInit")}}(),e.iLoggerInit=L,e.iLoggerIntegrate=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="";try{t=L(e)}catch(e){console.log("[lzd-h5-itrace] catch iTrace sdk error, make program go on!")}return A(e),x=e,N(e),t},e.iLoggerMtopPluginInit=N,e.iLoggerReportApi=M,e.iLoggerSelfDefineFSP=A,Object.defineProperty(e,"__esModule",{value:!0})}));
